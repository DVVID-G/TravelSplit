---
description: Enforces Atomic Design principles and component organization standards for TravelSplit frontend.
globs:
  - Frontend/src/components/**/*.tsx
alwaysApply: false
---

# Atomic Design Standards

## Rules

- Organize components using Atomic Design hierarchy: Atoms → Molecules → Organisms.
- Place components in appropriate directories: `atoms/`, `molecules/`, `organisms/`.
- Export all components from `components/index.ts` barrel file.
- Keep components focused on single responsibility.
- Compose complex components from simpler ones.
- Use consistent naming: `ComponentName.tsx` matching component name.

## Atomic Design Hierarchy

### Atoms
- Basic building blocks that cannot be broken down further.
- Examples: `Button`, `Input`, `Skeleton`, `Toast`.
- Self-contained and reusable.
- No business logic, only presentation.
- Accept props for customization.

### Molecules
- Simple combinations of atoms.
- Examples: `FormField`, `Card`, `CategorySelector`, `TripCard`.
- Composed of multiple atoms.
- May contain simple logic for composition.
- Reusable across different contexts.

### Organisms
- Complex components combining molecules and atoms.
- Examples: `Header`, `BottomTabBar`, `ExpenseForm`.
- May contain business logic and state management.
- Context-specific but reusable.
- May use hooks for data fetching.

## Component Organization

- Place atoms in `components/atoms/` directory.
- Place molecules in `components/molecules/` directory.
- Place organisms in `components/organisms/` directory.
- Export all components from `components/index.ts`.
- Use named exports, not default exports.

## Component Structure

- One component per file.
- File name matches component name: `Button.tsx` → `Button`.
- Export component as named export.
- Define props interface: `ComponentNameProps`.
- Include JSDoc comments for complex components.

## Composition Rules

- Atoms cannot import from molecules or organisms.
- Molecules can import from atoms only.
- Organisms can import from atoms, molecules, and other organisms.
- Pages compose organisms, molecules, and atoms.
- Avoid circular dependencies.

## DO

```typescript
// Atom: Button.tsx
interface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  children: ReactNode;
  variant?: 'primary' | 'secondary' | 'danger';
  size?: 'sm' | 'md' | 'lg';
}

export const Button = ({ children, variant = 'primary', size = 'md', ...props }: ButtonProps) => {
  const base = 'inline-flex items-center justify-center font-medium rounded-lg transition focus:outline-none focus:ring-2 focus:ring-offset-2';
  const variantClasses = {
    primary: 'bg-indigo-600 text-white hover:bg-indigo-700 focus:ring-indigo-500',
    secondary: 'bg-slate-100 text-slate-900 hover:bg-slate-200 focus:ring-slate-400',
    danger: 'bg-red-600 text-white hover:bg-red-700 focus:ring-red-500',
  } satisfies Record<NonNullable<ButtonProps['variant']>, string>;
  const sizeClasses = {
    sm: 'px-3 py-1.5 text-sm',
    md: 'px-4 py-2 text-base',
    lg: 'px-5 py-3 text-lg',
  } satisfies Record<NonNullable<ButtonProps['size']>, string>;

  return (
    <button
      className={`${base} ${variantClasses[variant]} ${sizeClasses[size]}`}
      {...props}
    >
      {children}
    </button>
  );
};

// Molecule: FormField.tsx (composes Input atom)
import { Input } from '../atoms/Input';

interface FormFieldProps {
  label: string;
  error?: string;
  children: ReactNode;
}

export const FormField = ({ label, error, children }: FormFieldProps) => {
  return (
    <div className="space-y-2">
      <label className="font-medium text-sm">{label}</label>
      {children}
      {error && <p className="text-sm text-red-500">{error}</p>}
    </div>
  );
};

// Organism: Header.tsx (composes Button and other components)
import { Button } from '../atoms/Button';
import { useAuthContext } from '@/contexts/AuthContext';

interface HeaderProps {
  title?: string;
  showActions?: boolean;
}

export const Header = ({ title = 'TravelSplit', showActions = true }: HeaderProps) => {
  const { isAuthenticated, logout } = useAuthContext();
  
  return (
    <header className="bg-white shadow-sm">
      <div className="flex justify-between items-center">
        <h1>{title}</h1>
        {showActions && (
          <nav>
            {isAuthenticated ? (
              <Button onClick={logout}>Cerrar Sesión</Button>
            ) : (
              <Button variant="primary">Iniciar Sesión</Button>
            )}
          </nav>
        )}
      </div>
    </header>
  );
};

// Barrel export: components/index.ts
export { Button } from './atoms/Button';
export { Input } from './atoms/Input';
export { FormField } from './molecules/FormField';
export { Card } from './molecules/Card';
export { Header } from './organisms/Header';
```

```typescript
// Page composing organisms, molecules, and atoms via barrel export
import { Header, Card, Button } from '@/components';

export function HomePage() {
  return (
    <div>
      <Header />
      <main>
        <Card title="Bienvenido">
          <Button>Crear Viaje</Button>
        </Card>
      </main>
    </div>
  );
}
```

## DON'T

```typescript
// VIOLATION: Atom importing from molecule
// atoms/Button.tsx
import { FormField } from '../molecules/FormField'; // VIOLATION: Atoms cannot import molecules

export const Button = () => {
  return <button>Click</button>;
};
```

```typescript
// VIOLATION: Component in wrong directory
// components/Button.tsx (should be in atoms/)
export const Button = () => {
  return <button>Click</button>;
};
```

```typescript
// VIOLATION: Multiple components in one file
// components/Buttons.tsx
export const PrimaryButton = () => <button>Primary</button>;
export const SecondaryButton = () => <button>Secondary</button>; // VIOLATION: Separate files
```

```typescript
// VIOLATION: Default export
// components/Button.tsx
export default function Button() { // VIOLATION: Use named export
  return <button>Click</button>;
}
```

```typescript
// VIOLATION: Circular dependency
// molecules/FormField.tsx
import { Button } from '../atoms/Button';

// atoms/Button.tsx
import { FormField } from '../molecules/FormField'; // VIOLATION: Circular dependency
```

```typescript
// VIOLATION: Business logic in atom
// atoms/Button.tsx
export const Button = () => {
  const { data } = useQuery({ queryKey: ['user'] }); // VIOLATION: Atoms should not fetch data
  return <button>{data?.name}</button>;
};
```

## Component Guidelines

### Atoms
- Pure presentation components.
- No side effects or data fetching.
- Highly reusable.
- Minimal props interface.
- No dependencies on other components.

### Molecules
- Compose atoms together.
- May have simple conditional logic.
- Reusable across contexts.
- May accept complex props.
- No business logic or data fetching.

### Organisms
- Complex UI sections.
- May use hooks for data fetching.
- May contain business logic.
- Context-specific but reusable.
- Compose molecules and atoms.

## Naming Conventions

- Component files: `PascalCase.tsx` (e.g., `Button.tsx`).
- Component names: `PascalCase` (e.g., `Button`).
- Props interfaces: `ComponentNameProps` (e.g., `ButtonProps`).
- Directory names: lowercase single words (no hyphens) for core folders, e.g., `atoms/`, `molecules/`, `organisms/`, `utils/`.

## Visual Consistency and Alignment Standards

### Button Alignment

- All buttons must use `flex items-center justify-center` in their base styles to ensure proper vertical and horizontal alignment of content (text and icons).
- Icons inside buttons must have `flex-shrink-0` class to prevent compression or distortion.
- Buttons with icons and text must maintain consistent spacing between icon and text using `gap-2` or `mr-2`/`ml-2` classes.
- Touch targets must meet minimum 44x44px (use `w-11 h-11` or `min-w-[44px] min-h-[44px]`) for mobile accessibility.
- Buttons with fixed size must use explicit padding (`p-2`, `px-3 py-1.5`) instead of relying only on `min-w`/`min-h` to ensure proper icon centering.

### Container Alignment and Symmetry

- Containers must use consistent padding: `p-6` (24px) for cards, `px-6 py-8` (24px horizontal, 32px vertical) for main containers.
- Flex containers must use `items-center` for vertical alignment and `justify-center` or `justify-between` for horizontal distribution.
- Grid layouts must use consistent gap spacing: `gap-3` (12px) or `gap-4` (16px).
- Containers with horizontal scroll must have sufficient lateral padding (`px-6` or `px-8`) to prevent content from touching borders.
- Centered content must use `mx-auto` or `flex justify-center` consistently.
- Asymmetric layouts must be intentional and justified by design requirements.

### Content Redundancy Prevention

- Avoid duplicate actions that perform the same function (e.g., two buttons navigating to the same route).
- Empty states should not include action buttons if the same action is available in the page header or navigation.
- Follow Design System Guide specifications: action buttons should be above empty states, not inside them.
- Review components for redundant UI elements that don't add value or create confusion.
- Each user action should have a single, clear entry point in the interface.

### Icon Alignment

- Icons must always have `flex-shrink-0` when used inside flex containers to prevent distortion.
- Icons with text must use consistent spacing: `gap-2` for flex containers, `mr-2` or `ml-2` for inline layouts.
- Icon sizes must be consistent: 16px for buttons, 20px for standard actions, 24px for headers, 64px for empty states.
- Icons must be properly aligned with text using `flex items-center` on the parent container.

### Spacing Consistency

- Use standard spacing scale: `space-y-4` (16px) for lists, `space-y-6` (24px) for forms, `gap-3` (12px) for flex/grid items.
- Maintain consistent padding across similar components (all cards use `p-6`, all modals use `p-6`).
- Vertical spacing between sections must be consistent: `mb-6` (24px) or `space-y-6` (24px).
- Horizontal spacing in headers and navigation must be symmetric: `px-6` (24px) on both sides.

### Loading State Consistency

- All loading states must use consistent indicators: `Loader2` from lucide-react with `animate-spin` for buttons, `Skeleton` component for content placeholders.
- Buttons with loading states must show spinner before text: `<Loader2 size={16} className="mr-2 animate-spin flex-shrink-0" />`.
- Loading text must be consistent: "Guardando...", "Cargando...", "Cerrando..." (present participle in Spanish).
- Loading indicators must be properly aligned with text using flex layout.

### Empty State Consistency

- Empty states must follow Design System Guide specifications for titles, descriptions, and icons.
- Action buttons in empty states are only allowed when the action is not available elsewhere in the interface.
- Empty state descriptions must guide users to the correct action location (e.g., "Toca el botón 'Agregar Gasto' arriba").
- Icons in empty states must use `slate-300` color and appropriate size (64px for large empty states).

## Exceptions

- Shared utilities may be in `utils/` directory.
- Hooks are in `hooks/` directory, not components.
- Types are in `types/` directory, not components.
